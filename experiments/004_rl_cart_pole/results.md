# RAY PPO

Pole cart is a physics problem where you can move the cart left and right.
The goal is to keep the pole upright for as long as possible.
More information on the environment: https://gymnasium.farama.org/environments/classic_control/cart_pole/

## RLLib

Starting with this config:

```
```
config = (
    PPOConfig()
    .environment(env="CartPole-v1")
    .framework("torch")
    .env_runners(num_env_runners=2)
    .training(
        train_batch_size=500,
        lr=0.0003,
        gamma=0.99,
        minibatch_size=128,
        num_epochs=5,
    )
    .evaluation(
        evaluation_interval=10,
        evaluation_duration=10,
    )
)
```


=== Iteration 1 ===
Episode Reward: 20.87 (min: 10, max: 49)
Policy Loss: -0.0178
Value Loss: 7.6651
Total Loss: 7.6528
Entropy: 0.6796
KL Divergence: 0.0278
VF Explained Variance: 0.0022
Total Steps Trained: 11025

=== Iteration 100 ===
Episode Reward: 235.36 (min: 34, max: 500)
Policy Loss: -0.0044
Value Loss: 9.4106
Total Loss: 9.4061
Entropy: 0.4722
KL Divergence: 0.0064
VF Explained Variance: 0.0226
Total Steps Trained: 1011181

## Part 2 - Sweep/tune

Using ray.tune sweep for different minibatch sizes to see how it affects convergence.

This test was with 4000 batch size larger than last.


Trial PPO_CartPole-v1_d4590_00000 finished iteration 150 at 2025-10-13 12:22:19. Total running time: 6min 53s
╭─────────────────────────────────────────────────────╮
│ Trial PPO_CartPole-v1_d4590_00000 result            │
├─────────────────────────────────────────────────────┤
│ env_runners/episode_len_mean                  493.8 │
│ env_runners/episode_return_mean               493.8 │
│ evaluation/env_runners/episode_return_mean   478.35 │
│ num_env_steps_sampled_lifetime               600000 │
╰─────────────────────────────────────────────────────╯
Trial PPO_CartPole-v1_d4590_00000 saved a checkpoint for iteration 150 at: (local)/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00000_0_minibatch_size=128_2025-10-13_12-15-26/checkpoint_000000

Trial PPO_CartPole-v1_d4590_00000 completed after 150 iterations at 2025-10-13 12:22:19. Total running time: 6min 53s
2025-10-13 12:22:19,913 INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/djole/ray_results/PPO_2025-10-13_12-15-26' in 0.0304s.

Trial status: 3 TERMINATED
Current time: 2025-10-13 12:22:19. Total running time: 6min 53s
Logical resource usage: 3.0/20 CPUs, 0/1 GPUs (0.0/1.0 accelerator_type:G)
╭───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Trial name                    status         minibatch_size     iter     total time (s)     ...lls_per_iteration     ..._sampled_lifetime │
├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ PPO_CartPole-v1_d4590_00000   TERMINATED                128      150            398.809                        1                   600000 │
│ PPO_CartPole-v1_d4590_00001   TERMINATED                200      150            368.549                        1                   600000 │
│ PPO_CartPole-v1_d4590_00002   TERMINATED                256      150            357.988                        1                   600000 │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
(PPO(env=CartPole-v1; env-runners=2; learners=0; multi-agent=False) pid=3885605) Checkpoint successfully created at: Checkpoint(filesystem=local, path=/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00000_0_minibatch_size=128_2025-10-13_12-15-26/checkpoint_000000)

ResultGrid<[
  Result(
    metrics={'timers': {'training_iteration': 2.350804981293387, 'restore_env_runners': 1.0593122043094336e-05, 'training_step': 2.35052711787496, 'env_runner_sampling_timer': 1.4447433748708003, 'learner_update_timer': 0.9037669475662016, 'synch_weights': 0.001417483202458125, 'synch_env_connectors': 0.001521475911128659, 'restore_eval_env_runners': 6.127626739381903e-06, 'evaluation_iteration': 3.2977999478182514, 'synch_eval_env_connectors': 9.933401112021791e-06}, 'env_runners': {'num_episodes': 8.0, 'env_to_module_connector': {'connector_pipeline_timer': np.float64(9.352508975994765e-05), 'timers': {'connectors': {'add_time_dim_to_batch_and_zero_pad': np.float64(1.4870815475685903e-06), 'numpy_to_tensor': np.float64(2.7335068028555403e-05), 'add_states_from_episodes_to_batch': np.float64(1.1015253840353858e-06), 'batch_individual_items': np.float64(1.5836617396283917e-05), 'add_observations_from_episodes_to_batch': np.float64(6.266904243822303e-06)}}}, 'env_to_module_sum_episodes_length_out': np.float64(203.42604391986947), 'episode_return_mean': 493.8, 'module_to_env_connector': {'timers': {'connectors': {'normalize_and_clip_actions': np.float64(2.2226157162907028e-05), 'remove_single_ts_time_rank_from_batch': np.float64(1.530488635395141e-06), 'listify_data_for_vector_env': np.float64(2.4659246363751528e-05), 'tensor_to_numpy': np.float64(4.4193596614481975e-05), 'get_actions': np.float64(0.00014419791295846142), 'un_batch_to_individual_items': np.float64(1.2441548113584117e-05)}}, 'connector_pipeline_timer': np.float64(0.0003116062841873728)}, 'episode_len_mean': 493.8, 'episode_duration_sec_mean': 0.32096258479868994, 'agent_episode_return_mean': {'default_agent': 493.8}, 'episode_return_max': 500.0, 'episode_return_min': 190.0, 'num_env_steps_sampled_lifetime': 600000.0, 'num_module_steps_sampled': {'default_policy': 4000.0}, 'num_module_steps_sampled_lifetime': {'default_policy': 600000.0}, 'env_reset_timer': np.float64(0.00025771651417016983), 'sample': np.float64(1.4060423078004272), 'num_episodes_lifetime': 1669.0, 'episode_len_max': 500, 'num_agent_steps_sampled_lifetime': {'default_agent': 600000.0}, 'env_step_timer': np.float64(4.680003909379851e-05), 'module_episode_return_mean': {'default_policy': 493.8}, 'num_agent_steps_sampled': {'default_agent': 4000.0}, 'rlmodule_inference_timer': np.float64(8.822874851802264e-05), 'num_env_steps_sampled': 4000.0, 'episode_len_min': 190, 'env_to_module_sum_episodes_length_in': np.float64(203.42604391986947), 'weights_seq_no': 149.0, 'time_between_sampling': np.float64(1.1981407565385904), 'num_env_steps_sampled_lifetime_throughput': np.float64(820.4414128137223)}, 'learners': {'default_policy': {'module_train_batch_size_mean': 128.0, 'num_module_steps_trained': 20096, 'gradients_default_optimizer_global_norm': np.float32(1.3103772), 'entropy': np.float32(0.21250173), 'vf_explained_var': np.float32(0.060245752), 'num_trainable_parameters': 134915, 'total_loss': np.float32(7.326144), 'vf_loss_unclipped': np.float32(1077.441), 'policy_loss': np.float32(0.047455616), 'diff_num_grad_updates_vs_sampler_policy': np.float32(1.0), 'curr_kl_coeff': 4.7645605176320567e-23, 'num_module_steps_trained_lifetime': 3016448, 'default_optimizer_learning_rate': 0.0003, 'mean_kl_loss': np.float32(0.0019626399), 'curr_entropy_coeff': 0.0, 'vf_loss': np.float32(7.278689), 'weights_seq_no': 150.0, 'num_module_steps_trained_lifetime_throughput': 26942.53140754483}, '__all_modules__': {'learner_connector_sum_episodes_length_in': 4000.0, 'num_module_steps_trained_lifetime': 3016448, 'learner_connector': {'timers': {'connectors': {'batch_individual_items': 0.042422256930502916, 'add_one_ts_to_episodes_and_truncate': 0.0043325692297768665, 'add_observations_from_episodes_to_batch': 0.00029448817516570706, 'add_time_dim_to_batch_and_zero_pad': 1.442414382048925e-05, 'numpy_to_tensor': 0.0001319545225022089, 'add_states_from_episodes_to_batch': 5.232100311390008e-06, 'general_advantage_estimation': 0.018660569994741066, 'add_columns_from_episodes_to_train_batch': 0.04396562964585168}}, 'connector_pipeline_timer': 0.11012339771618944}, 'num_env_steps_trained_lifetime': 94575031, 'num_non_trainable_parameters': 0, 'num_module_steps_trained': 20096, 'num_env_steps_trained': 629570, 'num_trainable_parameters': 134915, 'learner_connector_sum_episodes_length_out': 4048.005431895638, 'num_env_steps_trained_lifetime_throughput': 844141.0778002227, 'num_module_steps_trained_throughput': 26942.45542778179, 'num_module_steps_trained_lifetime_throughput': 26942.456103571625}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'episode_duration_sec_mean': 0.3180858787038596, 'num_env_steps_sampled_lifetime': 72761, 'num_agent_steps_sampled_lifetime': {'default_agent': 72761}, 'sample': 3.2910737695322876, 'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.495154148370055e-06, 'tensor_to_numpy': 4.402666944618446e-05, 'normalize_and_clip_actions': 2.2472470035339024e-05, 'get_actions': 0.00014944164837063357, 'un_batch_to_individual_items': 1.3159109915334659e-05, 'listify_data_for_vector_env': 2.5472011144843447e-05}}, 'connector_pipeline_timer': 0.0003199817194069685}, 'module_episode_return_mean': {'default_policy': 478.35}, 'rlmodule_inference_timer': 9.315152468161194e-05, 'env_to_module_sum_episodes_length_in': 404.2802310597345, 'weights_seq_no': 150.0, 'episode_return_mean': 478.35, 'episode_len_mean': 478.35, 'episode_return_max': 500.0, 'agent_episode_return_mean': {'default_agent': 478.35}, 'env_reset_timer': 0.0002030037356125759, 'env_to_module_connector': {'timers': {'connectors': {'add_time_dim_to_batch_and_zero_pad': 1.6047707728624478e-06, 'add_observations_from_episodes_to_batch': 6.555996925589033e-06, 'numpy_to_tensor': 2.868506716086154e-05, 'batch_individual_items': 1.6722188645331547e-05, 'add_states_from_episodes_to_batch': 1.118093878693718e-06}}, 'connector_pipeline_timer': 9.755518110274995e-05}, 'num_module_steps_sampled': {'default_policy': 4843}, 'num_episodes_lifetime': 150, 'env_step_timer': 4.871734471450225e-05, 'num_episodes': 10, 'episode_return_min': 189.0, 'num_module_steps_sampled_lifetime': {'default_policy': 72761}, 'episode_len_max': 500, 'num_agent_steps_sampled': {'default_agent': 4843}, 'num_env_steps_sampled': 4843, 'episode_len_min': 189, 'env_to_module_sum_episodes_length_out': 404.2802310597345, 'time_between_sampling': 23.059784156773937}, 'num_healthy_workers': 0, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 600000.0, 'fault_tolerance': {'num_healthy_workers': 2, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'perf': {'cpu_util_percent': np.float64(6.7), 'ram_util_percent': np.float64(34.875)}},
    path='/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00000_0_minibatch_size=128_2025-10-13_12-15-26',
    filesystem='local',
    checkpoint=Checkpoint(filesystem=local, path=/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00000_0_minibatch_size=128_2025-10-13_12-15-26/checkpoint_000000)
  ),
  Result(
    metrics={'timers': {'training_iteration': 2.158568980677385, 'restore_env_runners': 9.452509578560787e-06, 'training_step': 2.1583032799622566, 'env_runner_sampling_timer': 1.463963404337104, 'learner_update_timer': 0.6923581486196382, 'synch_weights': 0.0013731584882766745, 'synch_env_connectors': 0.0015115951798189472, 'restore_eval_env_runners': 5.9713153401663395e-06, 'evaluation_iteration': 1.61176208000738, 'synch_eval_env_connectors': 9.041748833941809e-06}, 'env_runners': {'env_to_module_connector': {'timers': {'connectors': {'add_observations_from_episodes_to_batch': np.float64(6.4650819522595215e-06), 'add_states_from_episodes_to_batch': np.float64(1.0992472780982365e-06), 'batch_individual_items': np.float64(1.6102386311099167e-05), 'add_time_dim_to_batch_and_zero_pad': np.float64(1.587282892227015e-06), 'numpy_to_tensor': np.float64(2.821242220158465e-05)}}, 'connector_pipeline_timer': np.float64(9.804556660906151e-05)}, 'module_episode_return_mean': {'default_policy': 492.1}, 'weights_seq_no': 149.0, 'module_to_env_connector': {'timers': {'connectors': {'un_batch_to_individual_items': np.float64(1.2540274382636087e-05), 'listify_data_for_vector_env': np.float64(2.5670634028114884e-05), 'remove_single_ts_time_rank_from_batch': np.float64(1.5165181954643166e-06), 'normalize_and_clip_actions': np.float64(2.2387427044015473e-05), 'get_actions': np.float64(0.00014768560209708936), 'tensor_to_numpy': np.float64(4.5024368970827064e-05)}}, 'connector_pipeline_timer': np.float64(0.0003203773564167564)}, 'num_env_steps_sampled': 4000.0, 'num_module_steps_sampled_lifetime': {'default_policy': 600000.0}, 'sample': np.float64(1.431052761639978), 'env_to_module_sum_episodes_length_in': np.float64(170.22779368519647), 'episode_len_min': 385, 'episode_duration_sec_mean': 0.33487531236140056, 'episode_len_mean': 492.1, 'episode_return_mean': 492.1, 'agent_episode_return_mean': {'default_agent': 492.1}, 'num_env_steps_sampled_lifetime': 600000.0, 'env_to_module_sum_episodes_length_out': np.float64(170.22779368519647), 'rlmodule_inference_timer': np.float64(8.971931591317148e-05), 'num_agent_steps_sampled': {'default_agent': 4000.0}, 'num_episodes_lifetime': 1719.0, 'env_reset_timer': np.float64(0.0002194829867221415), 'env_step_timer': np.float64(4.766739654094345e-05), 'num_module_steps_sampled': {'default_policy': 4000.0}, 'num_agent_steps_sampled_lifetime': {'default_agent': 600000.0}, 'episode_len_max': 500, 'num_episodes': 8.0, 'episode_return_min': 385.0, 'episode_return_max': 500.0, 'time_between_sampling': np.float64(0.9718938446994914), 'num_env_steps_sampled_lifetime_throughput': np.float64(871.6775905914789)}, 'learners': {'__all_modules__': {'num_env_steps_trained_lifetime': 60841133, 'learner_connector_sum_episodes_length_in': 4000.0, 'learner_connector': {'timers': {'connectors': {'batch_individual_items': 0.04252797933487913, 'general_advantage_estimation': 0.017096355707824782, 'add_time_dim_to_batch_and_zero_pad': 1.561169439482007e-05, 'add_observations_from_episodes_to_batch': 0.0002758608147722394, 'numpy_to_tensor': 0.00012734447845305234, 'add_states_from_episodes_to_batch': 5.6200930314215255e-06, 'add_one_ts_to_episodes_and_truncate': 0.004135351186578685, 'add_columns_from_episodes_to_train_batch': 0.041325689420883605}}, 'connector_pipeline_timer': 0.10581974023888467}, 'learner_connector_sum_episodes_length_out': 4046.7698622734038, 'num_env_steps_trained': 405010, 'num_trainable_parameters': 134915, 'num_module_steps_trained_lifetime': 3031800, 'num_non_trainable_parameters': 0, 'num_module_steps_trained': 20200, 'num_env_steps_trained_lifetime_throughput': 717029.6522997046, 'num_module_steps_trained_throughput': 35759.485659566984, 'num_module_steps_trained_lifetime_throughput': 35759.32250192998}, 'default_policy': {'module_train_batch_size_mean': 200.0, 'curr_entropy_coeff': 0.0, 'default_optimizer_learning_rate': 0.0003, 'num_trainable_parameters': 134915, 'num_module_steps_trained_lifetime': 3031800, 'vf_loss_unclipped': np.float32(970.536), 'gradients_default_optimizer_global_norm': np.float32(2.1941226), 'weights_seq_no': 150.0, 'vf_explained_var': np.float32(0.011274457), 'vf_loss': np.float32(5.598815), 'num_module_steps_trained': 20200, 'total_loss': np.float32(5.516473), 'mean_kl_loss': np.float32(0.0014728287), 'curr_kl_coeff': 7.754818550833426e-27, 'entropy': np.float32(0.17452301), 'policy_loss': np.float32(-0.08234212), 'diff_num_grad_updates_vs_sampler_policy': np.float32(1.0), 'num_module_steps_trained_lifetime_throughput': 35759.44654064982}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'module_to_env_connector': {'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.4201453432767856e-06, 'tensor_to_numpy': 4.2216053751808895e-05, 'get_actions': 0.00014395415452953664, 'un_batch_to_individual_items': 1.2217101151513542e-05, 'normalize_and_clip_actions': 2.2022574271621362e-05, 'listify_data_for_vector_env': 2.4415398000621564e-05}}, 'connector_pipeline_timer': 0.00030877096421804247}, 'weights_seq_no': 150.0, 'env_to_module_connector': {'timers': {'connectors': {'batch_individual_items': 1.5928474195665807e-05, 'add_observations_from_episodes_to_batch': 6.828661001492406e-06, 'add_time_dim_to_batch_and_zero_pad': 1.4630809344659466e-06, 'add_states_from_episodes_to_batch': 1.1103629354658263e-06, 'numpy_to_tensor': 2.7331164566361884e-05}}, 'connector_pipeline_timer': 9.414005372649799e-05}, 'episode_len_mean': 477.17, 'env_reset_timer': 0.0001969712114556787, 'num_module_steps_sampled_lifetime': {'default_policy': 67996}, 'num_episodes': 10, 'num_env_steps_sampled_lifetime': 67996, 'module_episode_return_mean': {'default_policy': 477.17}, 'episode_len_max': 500, 'episode_return_min': 204.0, 'num_env_steps_sampled': 5000, 'sample': 1.6218586268779227, 'episode_len_min': 204, 'num_agent_steps_sampled_lifetime': {'default_agent': 67996}, 'episode_duration_sec_mean': 0.31857632792321966, 'num_agent_steps_sampled': {'default_agent': 5000}, 'episode_return_mean': 477.17, 'agent_episode_return_mean': {'default_agent': 477.17}, 'env_to_module_sum_episodes_length_in': 404.2802310597345, 'num_module_steps_sampled': {'default_policy': 5000}, 'env_to_module_sum_episodes_length_out': 404.2802310597345, 'rlmodule_inference_timer': 8.706915884572527e-05, 'num_episodes_lifetime': 150, 'env_step_timer': 4.5860174564934344e-05, 'episode_return_max': 500.0, 'time_between_sampling': 21.420103875547785}, 'num_healthy_workers': 0, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 600000.0, 'fault_tolerance': {'num_healthy_workers': 2, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'perf': {'cpu_util_percent': np.float64(14.514285714285716), 'ram_util_percent': np.float64(38.957142857142856)}},
    path='/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00001_1_minibatch_size=200_2025-10-13_12-15-26',
    filesystem='local',
    checkpoint=Checkpoint(filesystem=local, path=/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00001_1_minibatch_size=200_2025-10-13_12-15-26/checkpoint_000000)
  ),
  Result(
    metrics={'timers': {'training_iteration': 2.0821636475169423, 'restore_env_runners': 9.750731260220594e-06, 'training_step': 2.0818870030546632, 'env_runner_sampling_timer': 1.4618101583349543, 'learner_update_timer': 0.6180404391538483, 'synch_weights': 0.001406921741512477, 'synch_env_connectors': 0.001543630857759027, 'restore_eval_env_runners': 6.234586268625896e-06, 'evaluation_iteration': 2.8364153735314095, 'synch_eval_env_connectors': 1.2588693734313619e-05}, 'env_runners': {'weights_seq_no': 149.0, 'episode_return_max': 500.0, 'env_to_module_connector': {'connector_pipeline_timer': np.float64(0.00010284766279885474), 'timers': {'connectors': {'add_observations_from_episodes_to_batch': np.float64(6.756418726763365e-06), 'add_states_from_episodes_to_batch': np.float64(1.2007283012969762e-06), 'batch_individual_items': np.float64(1.7207475101778075e-05), 'add_time_dim_to_batch_and_zero_pad': np.float64(1.6025776689548242e-06), 'numpy_to_tensor': np.float64(2.9596457153451046e-05)}}}, 'module_to_env_connector': {'timers': {'connectors': {'get_actions': np.float64(0.00015655518455479), 'remove_single_ts_time_rank_from_batch': np.float64(1.600672908840413e-06), 'listify_data_for_vector_env': np.float64(2.692734633541063e-05), 'un_batch_to_individual_items': np.float64(1.3518440377093774e-05), 'tensor_to_numpy': np.float64(4.694378846946803e-05), 'normalize_and_clip_actions': np.float64(2.408636897559335e-05)}}, 'connector_pipeline_timer': np.float64(0.00033873811121600173)}, 'num_agent_steps_sampled_lifetime': {'default_agent': 600000.0}, 'env_to_module_sum_episodes_length_out': np.float64(184.57392980052379), 'module_episode_return_mean': {'default_policy': 480.3}, 'env_to_module_sum_episodes_length_in': np.float64(184.57392980052379), 'num_agent_steps_sampled': {'default_agent': 4000.0}, 'episode_return_min': 362.0, 'env_step_timer': np.float64(5.040411763264809e-05), 'episode_return_mean': 480.3, 'env_reset_timer': np.float64(0.00022467397502623498), 'agent_episode_return_mean': {'default_agent': 480.3}, 'episode_duration_sec_mean': 0.3423661298607476, 'num_module_steps_sampled': {'default_policy': 4000.0}, 'num_episodes': 9.0, 'num_episodes_lifetime': 1728.0, 'rlmodule_inference_timer': np.float64(9.910572027912735e-05), 'sample': np.float64(1.4136893066943224), 'num_module_steps_sampled_lifetime': {'default_policy': 600000.0}, 'num_env_steps_sampled': 4000.0, 'episode_len_max': 500, 'episode_len_min': 362, 'num_env_steps_sampled_lifetime': 600000.0, 'episode_len_mean': 480.3, 'time_between_sampling': np.float64(0.9338122032128856), 'num_env_steps_sampled_lifetime_throughput': np.float64(909.5383694132821)}, 'learners': {'__all_modules__': {'num_trainable_parameters': 134915, 'learner_connector': {'timers': {'connectors': {'numpy_to_tensor': 0.00012979767783104332, 'add_observations_from_episodes_to_batch': 0.00028532029732739354, 'add_states_from_episodes_to_batch': 5.316248418001181e-06, 'add_columns_from_episodes_to_train_batch': 0.04329997904180028, 'add_one_ts_to_episodes_and_truncate': 0.004311336680263771, 'batch_individual_items': 0.04344051891499049, 'add_time_dim_to_batch_and_zero_pad': 1.4295556917745979e-05, 'general_advantage_estimation': 0.018220426391859872}}, 'connector_pipeline_timer': 0.11002507855763191}, 'learner_connector_sum_episodes_length_in': 4000.0, 'num_env_steps_trained': 316869, 'num_non_trainable_parameters': 0, 'num_module_steps_trained_lifetime': 3035136, 'num_env_steps_trained_lifetime': 47584998, 'learner_connector_sum_episodes_length_out': 4047.8792435840824, 'num_module_steps_trained': 20224, 'num_env_steps_trained_lifetime_throughput': 638020.6236108703, 'num_module_steps_trained_throughput': 40728.79184537982, 'num_module_steps_trained_lifetime_throughput': 40728.69080046605}, 'default_policy': {'weights_seq_no': 150.0, 'vf_explained_var': np.float32(0.2127316), 'curr_entropy_coeff': 0.0, 'num_module_steps_trained_lifetime': 3035136, 'curr_kl_coeff': 2.9080569565625346e-27, 'mean_kl_loss': np.float32(0.0010362478), 'policy_loss': np.float32(0.068225816), 'num_module_steps_trained': 20224, 'entropy': np.float32(0.25623763), 'vf_loss_unclipped': np.float32(909.0963), 'gradients_default_optimizer_global_norm': np.float32(1.2481394), 'num_trainable_parameters': 134915, 'total_loss': np.float32(6.72239), 'diff_num_grad_updates_vs_sampler_policy': np.float32(1.0), 'vf_loss': np.float32(6.6541643), 'module_train_batch_size_mean': 256.0, 'default_optimizer_learning_rate': 0.0003, 'num_module_steps_trained_lifetime_throughput': 40728.88651286639}}, 'num_training_step_calls_per_iteration': 1, 'evaluation': {'env_runners': {'env_to_module_sum_episodes_length_in': 306.59097439075845, 'episode_duration_sec_mean': 0.33169028666103256, 'rlmodule_inference_timer': 9.794868603271057e-05, 'num_agent_steps_sampled_lifetime': {'default_agent': 72387}, 'module_to_env_connector': {'connector_pipeline_timer': 0.00032658005350671895, 'timers': {'connectors': {'remove_single_ts_time_rank_from_batch': 1.5696821907031542e-06, 'listify_data_for_vector_env': 2.5404517643946353e-05, 'tensor_to_numpy': 4.5208182022669464e-05, 'normalize_and_clip_actions': 2.331361239361532e-05, 'un_batch_to_individual_items': 1.3221770692124367e-05, 'get_actions': 0.00015112122907246894}}}, 'episode_return_max': 500.0, 'episode_return_mean': 492.18, 'num_episodes_lifetime': 150, 'num_agent_steps_sampled': {'default_agent': 4421}, 'episode_len_max': 500, 'env_to_module_connector': {'timers': {'connectors': {'add_time_dim_to_batch_and_zero_pad': 1.6321996585761375e-06, 'add_states_from_episodes_to_batch': 1.1866780689696086e-06, 'numpy_to_tensor': 2.8882972299596564e-05, 'add_observations_from_episodes_to_batch': 6.8605320666169e-06, 'batch_individual_items': 1.6518343960531586e-05}}, 'connector_pipeline_timer': 9.793583427446798e-05}, 'num_env_steps_sampled_lifetime': 72387, 'env_to_module_sum_episodes_length_out': 306.59097439075845, 'episode_return_min': 389.0, 'num_module_steps_sampled': {'default_policy': 4421}, 'env_step_timer': 4.8438174228457026e-05, 'env_reset_timer': 0.00020095923854008415, 'sample': 2.8320099792268536, 'num_env_steps_sampled': 4421, 'episode_len_min': 389, 'episode_len_mean': 492.18, 'weights_seq_no': 150.0, 'num_module_steps_sampled_lifetime': {'default_policy': 72387}, 'num_episodes': 10, 'module_episode_return_mean': {'default_policy': 492.18}, 'agent_episode_return_mean': {'default_agent': 492.18}, 'time_between_sampling': 20.413636117035637}, 'num_healthy_workers': 0, 'actor_manager_num_outstanding_async_reqs': 0, 'num_remote_worker_restarts': 0}, 'num_env_steps_sampled_lifetime': 600000.0, 'fault_tolerance': {'num_healthy_workers': 2, 'num_remote_worker_restarts': 0}, 'env_runner_group': {'actor_manager_num_outstanding_async_reqs': 0}, 'perf': {'cpu_util_percent': np.float64(24.32857142857143), 'ram_util_percent': np.float64(43.01428571428572)}},
    path='/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00002_2_minibatch_size=256_2025-10-13_12-15-26',
    filesystem='local',
    checkpoint=Checkpoint(filesystem=local, path=/home/djole/ray_results/PPO_2025-10-13_12-15-26/PPO_CartPole-v1_d4590_00002_2_minibatch_size=256_2025-10-13_12-15-26/checkpoint_000000)
  )
]>



