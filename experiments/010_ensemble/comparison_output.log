2025-12-05 18:03:42,662	INFO worker.py:1951 -- Started a local Ray instance.
2025-12-05 18:03:42,725	INFO packaging.py:588 -- Creating a file package for local module '/home/djole/code/lab-work'.
2025-12-05 18:03:42,818	INFO packaging.py:380 -- Pushing file package 'gcs://_ray_pkg_133fd297b5ae5a38.zip' (16.26MiB) to Ray cluster...
2025-12-05 18:03:42,853	INFO packaging.py:393 -- Successfully pushed file package 'gcs://_ray_pkg_133fd297b5ae5a38.zip'.
2025-12-05 18:03:43,499	WARNING algorithm_config.py:5045 -- You are running PPO on the new API stack! This is the new default behavior for this algorithm. If you don't want to use the new API stack, set `config.api_stack(enable_rl_module_and_learner=False,enable_env_runner_and_connector_v2=False)`. For a detailed migration guide, see here: https://docs.ray.io/en/master/rllib/new-api-stack-migration-guide.html
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/rllib/algorithms/algorithm.py:520: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
`UnifiedLogger` will be removed in Ray 2.7.
  return UnifiedLogger(config, logdir, loggers=None)
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `JsonLogger interface is deprecated in favor of the `ray.tune.json.JsonLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `CSVLogger interface is deprecated in favor of the `ray.tune.csv.CSVLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `TBXLogger interface is deprecated in favor of the `ray.tune.tensorboardx.TBXLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
[2025-12-05 18:03:43,577 E 209781 209781] core_worker.cc:2246: Actor with class name: 'SingleAgentEnvRunner' and ID: '6a7edf67a9807d94f80bc27701000000' has constructor arguments in the object store and max_restarts > 0. If the arguments in the object store go out of scope or are lost, the actor restart will fail. See https://github.com/ray-project/ray/issues/53727 for more details.
[33m(raylet)[0m warning: `VIRTUAL_ENV=/home/djole/code/lab-work/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
[33m(raylet)[0m Using CPython 3.13.7
[33m(raylet)[0m Creating virtual environment at: .venv
[33m(raylet)[0m Installed 243 packages in 216ms
[36m(SingleAgentEnvRunner pid=211345)[0m 2025-12-05 18:03:56,377	WARNING deprecation.py:50 -- DeprecationWarning: `RLModule(config=[RLModuleConfig object])` has been deprecated. Use `RLModule(observation_space=.., action_space=.., inference_only=.., model_config=.., catalog_class=..)` instead. This will raise an error in the future!
[33m(raylet)[0m warning: `VIRTUAL_ENV=/home/djole/code/lab-work/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
2025-12-05 18:03:56,533	WARNING deprecation.py:50 -- DeprecationWarning: `RLModule(config=[RLModuleConfig object])` has been deprecated. Use `RLModule(observation_space=.., action_space=.., inference_only=.., model_config=.., catalog_class=..)` instead. This will raise an error in the future!
2025-12-05 18:03:57,225	INFO trainable.py:161 -- Trainable.setup took 13.716 seconds. If your trainable is slow to initialize, consider setting reuse_actors=True to reduce actor creation overheads.
2025-12-05 18:03:57,225	WARNING util.py:61 -- Install gputil for GPU system monitoring.
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/rllib/algorithms/algorithm.py:520: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
`UnifiedLogger` will be removed in Ray 2.7.
  return UnifiedLogger(config, logdir, loggers=None)
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `JsonLogger interface is deprecated in favor of the `ray.tune.json.JsonLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `CSVLogger interface is deprecated in favor of the `ray.tune.csv.CSVLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
/home/djole/code/lab-work/.venv/lib/python3.13/site-packages/ray/tune/logger/unified.py:53: RayDeprecationWarning: This API is deprecated and may be removed in future Ray releases. You could suppress this warning by setting env variable PYTHONWARNINGS="ignore::DeprecationWarning"
The `TBXLogger interface is deprecated in favor of the `ray.tune.tensorboardx.TBXLoggerCallback` interface and will be removed in Ray 2.7.
  self._loggers.append(cls(self.config, self.logdir, self.trial))
[36m(SingleAgentEnvRunner pid=211342)[0m 2025-12-05 18:03:56,377	WARNING deprecation.py:50 -- DeprecationWarning: `RLModule(config=[RLModuleConfig object])` has been deprecated. Use `RLModule(observation_space=.., action_space=.., inference_only=.., model_config=.., catalog_class=..)` instead. This will raise an error in the future![32m [repeated 3x across cluster][0m
[33m(raylet)[0m warning: `VIRTUAL_ENV=/home/djole/code/lab-work/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead[32m [repeated 2x across cluster][0m
2025-12-05 18:06:26,391	WARNING util.py:61 -- Install gputil for GPU system monitoring.

================================================================================
MODEL COMPARISON: Multi-LSTM Ensemble vs Simple LSTM
================================================================================

Environment: CartPole-v1
Training iterations: 50

Multi-LSTM Ensemble Config:
  hidden_size: 64
  num_lstms: 3
  num_layers: 1
  final_hidden_size: 128
  dropout: 0.1
  bidirectional: False
  use_projection: False
  projection_size: None

Simple LSTM Config:
  hidden_size: 192
  num_layers: 2
  dropout: 0.1
  bidirectional: False

================================================================================
Training multi_lstm_ensemble
================================================================================
Iter   Steps      Reward       P-Loss     V-Loss     Entropy   
----------------------------------------------------------------------
1      685,848     22.44 ( 10- 57)   -0.2034      8.40    0.6864
2      1,363,765   25.62 ( 11- 65)   -0.0919      8.14    0.6727
3      2,035,417   27.58 ( 12- 63)    0.0435      7.98    0.6564
4      2,697,932   32.78 ( 14- 86)   -0.0651      8.73    0.6306
5      3,358,515   41.03 ( 15-150)   -0.0641      8.87    0.5978
6      4,005,327   61.94 ( 23-204)   -0.0117      9.11    0.5990
7      4,652,457   64.81 ( 24-201)    0.0142      9.00    0.5960
8      5,295,612   90.63 ( 33-214)   -0.0525      9.42    0.5883
9      5,933,616  116.80 ( 30-297)   -0.1468      9.70    0.5868
10     6,570,514  141.68 ( 34-348)   -0.0349      9.60    0.5804
11     7,206,938  160.03 ( 35-348)    0.0953      9.66    0.5648
12     7,842,730  196.14 ( 35-400)    0.0789      9.48    0.5533
13     8,477,890  241.17 ( 40-500)   -0.0095      9.83    0.5689
14     9,108,716  269.41 (166-500)   -0.1281      9.86    0.5796
15     9,739,699  257.87 ( 49-500)    0.0593      9.75    0.5700
16     10,370,054 295.76 ( 49-500)    0.0323      9.90    0.5417
17     11,000,723 333.63 (146-500)   -0.0762      9.86    0.5540
18     11,630,764 362.07 (150-500)   -0.0234      9.78    0.5550
19     12,260,962 372.99 (150-500)    0.0348      9.85    0.5165
20     12,891,160 386.82 (194-500)    0.0355      9.91    0.5270
21     13,521,515 392.26 (138-500)   -0.0166      9.89    0.5686
22     14,156,833 276.64 ( 34-500)    0.0313      9.71    0.5351
23     14,786,874 306.20 ( 34-500)    0.0120      9.62    0.5575
24     15,416,915 373.83 ( 34-500)    0.0117      9.88    0.5469
25     16,046,956 443.23 (203-500)    0.0385      9.85    0.5528
26     16,676,840 460.53 (203-500)   -0.0859      9.87    0.5338
27     17,306,881 459.58 (164-500)   -0.0260      9.80    0.5114
28     17,936,765 476.39 (164-500)   -0.0199      9.88    0.5020
29     18,567,120 439.48 (164-500)   -0.1626      9.90    0.5046
30     19,197,004 442.84 (190-500)   -0.0336      9.87    0.4820
31     19,827,045 416.57 (151-500)   -0.0087      9.88    0.4974
32     20,456,929 449.41 (151-500)   -0.1178      9.87    0.4733
33     21,086,813 458.28 (151-500)   -0.0216      9.95    0.4565
34     21,716,854 483.23 (151-500)   -0.0008      9.88    0.4356
35     22,346,738 479.96 (233-500)    0.0092      9.82    0.4273
36     22,976,622 479.96 (233-500)    0.0327      9.85    0.4548
37     23,606,663 481.08 (196-500)    0.0098      9.79    0.4449
38     24,236,547 478.12 (196-500)   -0.0004      9.78    0.4089
39     24,866,588 466.80 (196-500)   -0.0180      9.92    0.4281
40     25,496,786 459.29 (185-500)    0.0463      9.83    0.4259
41     26,126,670 458.28 (185-500)   -0.0062      9.96    0.4295
42     26,756,554 478.28 (185-500)   -0.0515      9.77    0.4226
43     27,386,438 490.69 (217-500)   -0.0155      9.85    0.4028
44     28,016,322 500.00 (500-500)    0.0706      9.90    0.4183
45     28,646,206 500.00 (500-500)   -0.0415      9.95    0.4536
46     29,276,090 500.00 (500-500)   -0.0601      9.87    0.4653
47     29,905,974 500.00 (500-500)    0.0504      9.74    0.4404
48     30,535,858 500.00 (500-500)   -0.0401      9.88    0.4133
49     31,165,742 500.00 (500-500)   -0.0526      9.78    0.4062
50     31,795,626 500.00 (500-500)   -0.0143      9.90    0.4105

multi_lstm_ensemble completed!
Best reward: 500.00
Final reward: 500.00
Total time: 144.0s

================================================================================
Training simple_lstm
================================================================================
Iter   Steps      Reward       P-Loss     V-Loss     Entropy   
----------------------------------------------------------------------
1      686,504     19.90 (  9- 67)   -0.0695      7.90    0.6882
2      1,365,725   25.65 ( 10- 74)    0.0437      7.90    0.6791
3      2,041,849   23.16 ( 10- 58)   -0.0637      8.63    0.6563
4      2,704,203   34.18 ( 10- 80)   -0.0011      8.38    0.6181
5      3,357,323   49.19 ( 12-105)   -0.0676      8.92    0.6110
6      4,009,803   56.93 ( 21-146)   -0.1347      8.86    0.5836
7      4,654,548   71.97 ( 18-199)    0.0147      9.14    0.5742
8      5,291,920  130.23 ( 63-269)   -0.0384      9.62    0.5770
9      5,928,818  145.41 ( 42-270)   -0.0496      9.53    0.5972
10     6,565,084  161.77 ( 28-271)   -0.0437      9.70    0.5832
11     7,201,192  180.91 ( 42-298)   -0.0027      9.82    0.5855
12     7,836,668  218.39 ( 42-500)    0.0249      9.68    0.5792
13     8,467,180  251.87 ( 82-500)   -0.0240      9.71    0.5491
14     9,097,692  314.36 ( 82-500)    0.0436      9.86    0.5588
15     9,728,518  336.24 (123-500)    0.0743      9.84    0.5456
16     10,358,716 332.77 (123-500)    0.0333      9.93    0.5457
17     10,989,228 350.00 (163-500)    0.1348      9.91    0.5585
18     11,619,897 346.92 (188-500)   -0.0211      9.78    0.5434
19     12,249,781 374.27 (188-500)    0.0068      9.85    0.5505
20     12,880,136 369.12 (194-500)   -0.0313      9.90    0.5727
21     13,510,962 341.46 ( 64-500)    0.0482      9.85    0.5308
22     14,141,160 348.97 ( 64-500)   -0.0232      9.71    0.5530
23     14,771,201 363.60 ( 93-500)   -0.0337      9.79    0.5570
24     15,401,085 403.98 (111-500)    0.0262      9.88    0.5498
25     16,031,440 433.10 (277-500)    0.1272      9.72    0.5458
26     16,661,324 445.77 (308-500)    0.1208      9.86    0.5626
27     17,291,522 445.58 (111-500)   -0.0517      9.92    0.5219
28     17,921,406 460.14 (111-500)   -0.1448      9.84    0.5439
29     18,551,447 448.43 (111-500)    0.0331      9.82    0.5379
30     19,181,488 439.88 (111-500)    0.0451      9.88    0.5313
31     19,811,529 432.17 (281-500)   -0.0848      9.97    0.5120
32     20,441,413 433.90 (222-500)    0.0193      9.86    0.5211
33     21,071,611 454.65 (222-500)   -0.0103      9.76    0.5151
34     21,701,652 464.55 (222-500)   -0.0683      9.82    0.5409
35     22,332,164 407.02 (191-500)    0.0352      9.77    0.5650
36     22,962,205 371.98 (191-500)    0.0057      9.80    0.5343
37     23,592,560 391.01 (267-500)    0.0701      9.82    0.4957
38     24,222,444 418.15 (269-500)    0.0558      9.79    0.5507
39     24,852,328 429.50 (280-500)   -0.0369      9.85    0.5097
40     25,482,683 430.50 (280-500)   -0.0369      9.84    0.5419
41     26,112,724 434.41 (280-500)   -0.0432      9.82    0.5505
42     26,742,608 445.81 (283-500)   -0.0254      9.82    0.5436
43     27,372,492 464.18 (308-500)   -0.0582      9.71    0.5533
44     28,002,690 461.04 (266-500)   -0.0377      9.62    0.5555
45     28,632,731 439.79 (266-500)    0.0433      9.78    0.5569
46     29,263,086 412.45 (265-500)    0.0808      9.81    0.5590
47     29,893,598 373.46 (108-500)   -0.0905      9.74    0.5072
48     30,523,639 390.07 (108-500)   -0.0670      9.83    0.5501
49     31,153,680 386.61 (108-500)   -0.0952      9.91    0.5414
50     31,783,878 410.20 (242-500)   -0.0610      9.76    0.5130

simple_lstm completed!
Best reward: 464.55
Final reward: 410.20
Total time: 138.5s

Comparison plot saved to: comparison_logs/model_comparison.png
Convergence plot saved to: comparison_logs/model_comparison_convergence.png

================================================================================
SUMMARY STATISTICS
================================================================================[36m(SingleAgentEnvRunner pid=229321)[0m 2025-12-05 18:06:26,356	WARNING deprecation.py:50 -- DeprecationWarning: `RLModule(config=[RLModuleConfig object])` has been deprecated. Use `RLModule(observation_space=.., action_space=.., inference_only=.., model_config=.., catalog_class=..)` instead. This will raise an error in the future![32m [repeated 4x across cluster][0m
[33m(raylet)[0m warning: `VIRTUAL_ENV=/home/djole/code/lab-work/.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead[32m [repeated 2x across cluster][0m


Steps to Reach Reward Thresholds:
Threshold    Multi-LSTM Ensemble       Simple LSTM               Winner         
--------------------------------------------------------------------------------
50           4,005,327                 4,009,803                 Ensemble (0.1% faster)
100          5,933,616                 5,291,920                 Simple LSTM (10.8% faster)
150          7,206,938                 6,565,084                 Simple LSTM (8.9% faster)
195          7,842,730                 7,836,668                 Simple LSTM (0.1% faster)

Final Performance:
Multi-LSTM Ensemble: 500.00 (steps: 31,795,626)
Simple LSTM:         410.20 (steps: 31,783,878)

Best Performance:
Multi-LSTM Ensemble: 500.00 at iteration 44
Simple LSTM:         464.55 at iteration 34

Average Performance (last 10 iterations):
Multi-LSTM Ensemble: 492.73
Simple LSTM:         421.80

Ensemble is 16.8% better on average

================================================================================
Comparison complete!
CSV files saved:
  - comparison_logs/multi_lstm_ensemble_20251205_180357.csv
  - comparison_logs/simple_lstm_20251205_180626.csv
Plots saved:
  - comparison_logs/model_comparison.png
  - comparison_logs/model_comparison_convergence.png
================================================================================
